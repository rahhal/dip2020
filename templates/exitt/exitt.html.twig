
{% extends 'base.html.twig' %}

{% block title %} {{ app.user.email|upper }} {% endblock %}
{% block body_class %} class="nav-md" {% endblock %}

{% block body %}
   {# <style>

        .border_error {
            border: 1px solid red;
        }
        .error_style {
            color: red;
        }

    </style>#}
    <div hidden id="template_tmp">
        <div id="exitt_lineExitt___name__">
            <label class="required">__name__label__</label>
            <div class="row">

                <div class="col-md-3">
                    <label for="exitt_lineExitt___name__article" class="required ">{{ "Article name"|trans }}</label>
                    <span class="required">*</span>
                    <select id="exitt_lineExitt___name___article" class="form-control"
                            name="exitt[lineExitts][__name__][article]">
                        {% for article in articles %}
                            <option value="{{ article.id }}">{{ article.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="exitt_lineExitt___name__quantity" class="required"> {{ "Quantity"|trans }}  </label>
                    <span class="required">*</span>
                    <input type="text" id="exitt_lineExitt___name__quantity" class=" form-control"
                            name="exitt[lineExitts][__name__][quantity]" required="required"/>
                    {#<span data-color="red" id="quantity_result"></span>#}
                </div>

                <div class="col-md-1">
                    <label></label>
                    <a href="#" class="btn btn-danger" id="btn-delete">{{ "Delete"|trans }}</a>
                </div>
            </div>
        </div>
    </div>
    <div class="container body">
        <div class="main_container">
            <div class="col-md-3 left_col hidden-print">
                {% include('layouts/sidebar.html.twig') %}
            </div>
            {% include('layouts/navbar.html.twig') %}
            <!-- page content -->
            <div class="right_col" role="main">
                <div class="page-title">
                    <div class="title_left">
                        <h3>{{ "Create new exit"|trans }}</h3>
                    </div>
                </div>

                <div class="clearfix">
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="x_panel">
                                <div class="x_content">
                                    <br/>
                                    {{ form_start(form, {'attr': {'class': 'form-horizontal form-label-left'}}) }}

                                    <fieldset>
                                        <div class="row">
                                            <div class="well">
                                                <div class="form-group">
                                                    {{ form_label(form.date, "Date"|trans, {'label_attr': {'class': 'col-sm-2 control-label'}}) }}
                                                    <div class="col-sm-4">
                                                        {{ form_widget(form.date) }}
                                                        <div class="invalid-feedback text-danger">{{ form_errors(form.date) }}</div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                {# Génération du label. #}
                                                    {{ form_label(form.number, "Reference exit"|trans, {'label_attr': {'class': 'col-sm-2 control-label'}}) }}
                                                    <div class="col-sm-6">
                                                {# Génération de l'input. #}
                                                        {{ form_widget(form.number, {'attr': {'class': 'form-control'}}) }}
                                                {# Affichage des erreurs pour ce champ précis. #}
                                                        <div class="invalid-feedback text-danger">{{ form_errors(form.number) }}</div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    {{ form_label(form.employee, "Benificiary"|trans, {'label_attr': {'class': 'col-sm-2 control-label'}}) }}
                                                    <div class="col-sm-6">
                                                        {{ form_widget(form.employee, {'attr': {'class': 'form-control'}}) }}
                                                        {# Affichage des erreurs pour ce champ précis. #}
                                                        <div class="invalid-feedback text-danger">{{ form_errors(form.employee) }}</div>
                                                    </div>
                                                </div>
                                               {# <div class="form-group">
                                                    {{ form_label(form.total_price, "Total price"|trans, {'label_attr': {'class': 'col-sm-2 control-label'}}) }}
                                                    <div class="col-sm-6">
                                                        {{ form_widget(form.total_price, {'attr': {'class': 'form-control'}}) }}
                                                        {# Affichage des erreurs pour ce champ précis.
                                                    <div class="invalid-feedback text-danger"> {{ form_errors(form.total_price) }}</div>
                                                    </div>
                                                </div>#}
                                            </div>
                                        </div>
                                    </fieldset>
                                    <fieldset>
                                        <div class="row">
                                            <div class="well">

                                                {#<div id="exitt_lineExitt" class="register"></div></br>#}
                                                <div id="exitt_lineExitt"></div></br>
                                                <a href="#" id="add_lineExitt" class="btn btn-success m-10">{{ "Create new article"|trans }}</a>
                                                 {{ form_widget(form.save, {'attr': {'class': 'btn btn-primary'}}) }}

                                            </div>
                                        </div>
                                    </fieldset>
                                    {# Pour le bouton, pas de label ni d'erreur,
                                     on affiche juste le widget #}
                                    {{ form_widget(form._token) }}
                                    {{ form_end(form, {'render_rest': false}) }}

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% include('layouts/footer.html.twig') %}
            </div>

        
        </div>
    </div>


{% endblock %}
{#
{% block javascripts %}
    <script>
    $(".register").click(function() {
    var quantity = $('#exitt_lineExitt_0quantity').val();
    console.log('La valeur récupéreé est:'+quantity)
    $('#exitt_lineExitt_0quantity').removeClass("border_error");
    console.log('Ref : '+quantity);
    var response = $.ajax({
    type: "GET",
    url: "{{ url('quantity_check_disponibility') }}",
    data: {quantity: quantity},//(parametre: valeur)
    async: false
    }).responseText;

    console.log(response);

    if(response == 'indisponible'){
    $('#exitt_lineExitt_0quantity').addClass("border_error");
    $('#quantity_result').addClass("error_style");
    $("#quantity_result").text("لا يمكن:هذه الكمية غير متوفرة بالمخزن");
    return false;
    }
    else if(response == 'notice'){
        $('#exitt_lineExitt_0quantity').addClass("border_error");
        $('#quantity_result').addClass("error_style");
        $("#quantity_result").text("لقد تجاوزت كمية الانذار");
        return true;
    }
        else{
    return true;
    }
    });
    </script>
{% endblock %}

#}

